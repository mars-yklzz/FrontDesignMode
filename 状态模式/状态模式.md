## 状态模式
1. 什么是状态模式
2. 状态模式的实现
3. 状态模式在框架中应用
4. 状态模式的优缺点
5. 状态模式的应用场景
6. 和状态模式相似的模式

### 什么是状态模式
> 状态模式允许一个对象的内部状态改变时改变其自身的行为, 对象似乎修改了类,类的行为随状态的改变而改变
状态模式主要解决的是当一个对象状态的条件表达式过于复杂时的情况.把状态的判断逻辑转移到不同状态的一系列类中,可以把复杂的判断逻辑简化

特点
- 对象有有限多个状态,切张贴可以相互切换
- 各个状态和对象的行为逻辑有比较强的对应关系,即在不同的状态时,对应的处理逻辑不一样     

### 状态模式的实现
如果你读过一些早期的设计模式教学资料，有一种思路是将每一个状态所对应的的一些行为抽象成类，然后通过传递 this 的方式来关联状态和状态主体。
这种思路也可以，不过它一般还需要你实现抽象工厂，比较麻烦。实际业务中这种做法极为少见。我这里要给大家介绍的是一种更方便也更常用的解决方案——非常简单，把状态-行为映射对象作为主体类对应实例的一个属性添加进去就行了：
```js
class CoffeeMaker {
            constructor() {
                this.state = 'init'
                this.leftMilk = '500ml'
            }

            stateToProcessor = {
                that: this,
                american() {
                    // 尝试在行为函数里拿到咖啡机实例的信息并输出
                    console.log('咖啡机现在的牛奶存储量是:', this.that.leftMilk)
                    console.log('我只吐黑咖啡');
                },
                latte() {

                },
                vanillaLatte() {

                },
                mocha() {

                }
            }
            changeState(state) {
                this.state = state
                if (!this.stateToProcessor[state]) {
                    return
                }
                this.stateToProcessor[state]()
            }
        }
        const mk = new CoffeeMaker();
        mk.changeState('american');
```

### 状态模式的优缺点
优点
- 结果清晰,避免了过多的switchcase和ifelse语句的使用,避免了程序的复杂性提高系统的可维护性
- 符合开闭原则
- 封装性良好,状态的切换在类的内部实现,外部的调用无须知道内内部如何实现状态和行为的变换

缺点
- 引入了多余的类,每个状态都有对应的类,导致系统中类的个数增加

### 应用场景
- 操作中含有庞大的多分支条件语句,可以考虑状态模式,且这些分支依赖于该对象的状态,那么可以使用状态模式来将分支的处理分散到单独的状态类中
- 对象的行为随着状态的改变而改变,那么可以考虑状态模式,来把状态和行为分离,虽然分离了,但是状态和行为是对应的,再通过改变状态调用状态对应的行为

### 状态模式和其他模式的区别
- 状态模式: 状态模式重点强调对象内部状态改变而改变行为,状态类之间相互平行,无法相互替换
- 策略模式: 策略的选择由外部条件决定,策略可以动态切换,策略之间是相互平等的,可以相互替换